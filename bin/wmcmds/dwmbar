#!/bin/sh

fnews()
{
	rnews=$(news)
	[ "${rnews}" != "" ] && echo "ğŸ“° ${rnews} | "
}

fpacpackages()
{
	rpac=$(pacpackages)
	[ "${rpac}" != "" ] && echo "ğŸ“¦ ${rpac} | "
}

fmailbox()
{
	rbox=$(mailbox)
	[ "${rbox}" != "" ] && echo "ğŸ“¬ ${rbox} | "
}

fweather()
{
	rweather=$(weather)
	[ "${rweather}" != "" ] && echo "${rweather} | "
}

fbattery()
{
	capacity=$(cat /sys/class/power_supply/"$1"/capacity) || exit
	status=$(cat /sys/class/power_supply/"$1"/status)

	[ "${capacity}" -lt 25 ] && warn="â—" || warn=" "
	printf "%s%s%s" "$(echo "$status" | sed -e "s/,//;s/Discharging/ğŸ”‹/;s/Not Charging/ğŸ›‘/;s/Charging/ğŸ”Œ/;s/Unknown/â™»ï¸/;s/Full/âš¡/;s/ 0*/ /g;s/ :/ /g")" "$warn" "$(echo "$capacity" | sed -e 's/$/%/')"
}

while true; do
	xsetroot -name "$(fnews)$(fpacpackages)$(fmailbox)$(fweather)$(volume) | $(internet) | $(fbattery BAT1) | $(fbattery BAT2) | ğŸ“… $(clock)"

	sleep 1m
done
